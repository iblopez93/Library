This is the chapter 3. With mods. An more 3 code. Test. With adding
Modified in experimental branches